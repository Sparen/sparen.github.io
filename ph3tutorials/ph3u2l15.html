<!DOCTYPE html><html lang="en-us">  <head>    <meta charset="utf-8">    <title>AFCDTech - Sparen's Danmakufu ph3 Tutorials - Lesson 15</title>    <link rel="stylesheet" type="text/css" href="../blah.css">
    <link rel="stylesheet" type="text/css" href="docs.css">    <meta content="Sparen's Danmakufu ph3 Tutorials Lesson 15 - Using Danmakufu's Sound Functions. A guide to understanding and using Touhou Danmakufu ph3's built-in sound capabilities."      name="description">
    <meta name="keywords" content="Sparen, Touhou, Danmakufu, ph3, Tutorial, Script, Danmaku, Plural, Boss, Music, Sound">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-58194930-1', 'auto');
    ga('send', 'pageview');
  </script>  </head>  <body onload="setupENG('Jul 02, 2018')">    <div class="yui-t1" id="top">      <p style="text-align: center;"><a href="https://sparen.github.io"><img alt="Site Logo" src="../images/logo.png" style="width:100%;max-width:1000px"></a></p>      <br>      <div class="docsmenubar">
        <ul>
          <li class="dmbnona"><hr>&nbsp;&nbsp;Site Navigation<hr></li>
          <li><a href="https://sparen.github.io" title="AFCDTech">Return to Home</a></li>
          <li><a href="./ph3tutorials.html" title="Sparen's Danmakufu ph3 Tutorials">ph3 Tutorial Index</a></li>
          <li><a target="_blank" href="http://dmf.shrinemaiden.org/wiki/Main_Page">Danmakufu Wiki</a></li>
          <li><a target="_blank" href="http://dmf.shrinemaiden.org/wiki/Functions_(ph3)">Ph3 Function List (DNH Wiki)</a></li>
          <li><a href="./ph3style.html" title="ph3 Style Guidelines">ph3 Style Guidelines</a></li>
          <li class="dmbnona"><hr>&nbsp;&nbsp;Function Reference<hr></li>
          <li><a href="./docs.html">Function List</a></li>
          <li><a href="./docs_standard.html">General Functions</a></li>
          <li><a href="./docs_object.html">Object Functions</a></li>
          <li><a href="./docs_system.html">Player Script Fxns</a></li>
          <li><a href="./docs_system.html">Private Script Fxns</a></li>
          <li class="dmbnona"><hr>&nbsp;&nbsp;Lesson Resources<hr></li>
	  <li><a href="./docs_standard.html#sub7">Audio Functions</a></li>
	  <li><a href="./docs_object.html#sub10">Sound Obj Fxns</a></li>
        </ul>
      </div>      <div id="bd">        <div id="yui-main">          <div class="yui-b">            <div class="yui-g">
              <div class="tutnavbar">
	        <ul>
	          <li><a href="./ph3u2l14.html" title="Sparen's Danmakufu ph3 Tutorials - Utilizing Blend Types in Danmakufu">Unit 2 Lesson 14</a></li>
	          <li><span>Navigation Bar</span></li>
	          <li><a href="./ph3u2l16.html" title="Sparen's Danmakufu ph3 Tutorials - Object Autodeletion and (0,0) Spawning">Unit 2 Lesson 16</a></li>
	        </ul>
              </div>	      <h1 class="toplevelheadera">Sparen's Danmakufu ph3 Tutorials Lesson 15 - Using Danmakufu's Sound Functions</h1>	      <p>The video for this lesson is Trickysticks's Youmu, Half Ghost Gardener, chosen due to its exceptional quality and effective sound and music choices.</p>
	      <!--Embedded video below. Make sure to format the link correctly-->
	      <div class="ytembed_sm">
	        <iframe src="https://www.youtube.com/embed/WL-EsFi0rqw" frameborder="0" allowfullscreen></iframe>
	      </div>
	      <div class="tutorialnav">
	        <h2 class="tocheader">Table of Contents</h2>
	        <ul>
	          <li><a href="#sub1">Part 1: What will be Covered in this Lesson?</a></li>
	          <li><a href="#sub2">Part 2: How do I Use Danmakufu's Audio Functions?</a></li>
	          <li><a href="#sub3">Part 3: Which File Types Should I Use?</a></li>
	          <li><a href="#sub4">Part 4: How do I Create Sound Objects?</a></li>
	          <li><a href="#sub5">Part 5: How do I Use and Manipulate Sound Objects?</a></li>
	          <li><a href="#quiz1">Quiz: Sounds in Danmakufu</a></li>
	          <li><a href="#sub6">Part 6: How Can I Use Audacity to Export to .ogg?</a></li>
	          <li><a href="#subs">Summary</a></li>
	          <li><a href="#subf">Sources and External Resources</a></li>
	        </ul>
	      </div>	      <h2 class="ph3tutorialheader" id="sub1">Part 1: What will be Covered in this Lesson?</h2>
	      <p>Sound is very important in any form of modern video game. Using sound effects and background music effectively make the experience significantly better, and they provide mood, ambience, and style. Of course, there are multiple ways to implement sound in Danmakufu, and we will go into these shortly.</p>
	      <p>Before reading this guide, I expect that you already understand what .mp3 and .wav files are. I will cover .ogg files (OGG Vorbis) briefly, as they are the preferred option for BGM tracks in Danmakufu, but I will not cover .mp3 and .wav files. Note that this guide requires that you do not use #BGM, as these sound functions are in fact a replacement for #BGM in Stage scripts and Plural scripts.</p>
	      <h2 class="ph3tutorialheader" id="sub2">Part 2: How do I Use Danmakufu's Audio Functions?</h2>
	      <p>To begin the lesson, I will explain the beginner-level audio functions that come prepackaged with Danmakufu. These <a href="./docs_standard.html#sub7">Audio Functions</a> require little to no effort to use, and are easier to understand and utilize than Sound Objects. But of course, they have their limitations.</p>
	      <p>Now, there are a number of Audio Functions. <span class="tooltip" onmouseover="getFxnDocs('LoadSound', 'f_loadsound_01');"><code>LoadSound()</code><span class="tooltiptext" id="f_loadsound_01"></span></span> MUST be called prior to using <span class="tooltip" onmouseover="getFxnDocs('PlayBGM', 'f_playbgm_01');"><code>PlayBGM()</code><span class="tooltiptext" id="f_playbgm_01"></span></span> or <span class="tooltip" onmouseover="getFxnDocs('PlaySE', 'f_playse_01');"><code>PlaySE()</code><span class="tooltiptext" id="f_playse_01"></span></span>, as Danmakufu must load the audio files into memory. Additionally, LoadSound must be used in the same script as the Play functions. If you LoadSound in a System script, you cannot PlaySE with the same path in a Single script and expect the sound to play. You must load the files in the same script where you play them.</p>
	      <p>Of course, looking at the function list, there is also a <span class="tooltip" onmouseover="getFxnDocs('RemoveSound', 'f_removesound_01');"><code>RemoveSound()</code><span class="tooltiptext" id="f_removesound_01"></span></span>. If you do use <code>LoadSound()</code>, please use <code>RemoveSound()</code> in @Finalize. Removing loaded sounds is one of the only  uses of @Finalize in ph3.</p>
	      <p>There are two Play functions and one Stop function, and their usage should be clear from the documentation on the Wiki. You give a path to the loaded sound effect or bgm track, and for BGM, you also give loop points. Anyways, it's about time I elaborated on what is acceptable for a BGM track and what is acceptable for a Sound Effect.</p>
	      <h2 class="ph3tutorialheader" id="sub3">Part 3: Which File Types Should I Use?</h2>
	      <p>Most people don't really know any better when it comes to audio files. I mean, they all hold sound, right? Well, yes. But each file type has its own strengths and weaknesses.</p>
	      <p>First, .mp3, which is undeniably the most popular way to share music due to its relatively small size, since it doesn't keep track of the parts of the music inaudible to most humans. In essence, it's meant for keeping audio tracks small. Unfortunately, it is not so great when looping. .mp3 tracks are used as BGM tracks but never for Sound Effects.</p>
	      <p>Next is .wav, which is uncompressed. In other words, they are gigantic. Some scripters find it convenient to use .wav files as BGM. <strong>This is not acceptable.</strong> A 50 MB .wav can easily be exported to a 10 MB .ogg, saving the user a lot in download time and disk space. However, for sound effects, .wav files are the preferred option because they are very small in file size and high-quality.</p>
	      <p>Then of course, there is OGG Vorbis. OGG Vorbis is Open Source and completely free, and works excellently as BGM in Danmakufu due to the support for looping. If you are going to loop your BGM, <strong>please do not open the track in Audacity and copy-paste the looped section 10 times or download a super extended version from Youtube.</strong> All you are doing is providing the player of your script with music files that are probably 5-10x as big as they should be. Simply export as .ogg using Audacity. Note that .ogg are rarely if ever used as Sound Effects. So don't use them for Sound Effects unless you're really trying to save space.</p>
	      <p>In conclusion, use .ogg for BGM and .wav for Sound Effects.</p>
	      <div class="tut_checkpoint">CHECKPOINT: Why are .wav tracks not preferred for BGM?</div>
	      <h2 class="ph3tutorialheader" id="sub4">Part 4: How do I Create Sound Objects?</h2>
	      <p>Now, I've already discussed the uses of Danmakufu's default audio functions. But what if you want to loop your tracks at a certain point? What if you want to control the volume? Now we're getting into Sound Object territory.</p>
	      <p>First, let's begin by creating Sound Objects. The <a href="./docs_object.html#sub10">Sound Object Functions</a> are pretty confusing for those who are unfamiliar with dealing with music, so we'll go through them.</p>
	      <p>To create a Sound Object, we use <span class="tooltip" onmouseover="getFxnDocs('ObjSound_Create', 'f_osoundc_01');"><code>ObjSound_Create()</code><span class="tooltiptext" id="f_osoundc_01"></span></span>, which returns the ID of your sound object. A single sound object can be played multiple times.</p>
	      <p>Once you have created a sound object, you must give it a file path to the sound you want it to play, whether it is a bgm or a sound effect. You use <span class="tooltip" onmouseover="getFxnDocs('ObjSound_Load', 'f_osoundl_01');"><code>ObjSound_Load(obj, filepath)</code><span class="tooltiptext" id="f_osoundl_01"></span></span> to load a given sound file to the object. You can override this by loading a different sound at any time. After this, it is recommended to use <span class="tooltip" onmouseover="getFxnDocs('ObjSound_SetSoundDivision', 'f_osoundssd_01');"><code>ObjSound_SetSoundDivision()</code><span class="tooltiptext" id="f_osoundssd_01"></span></span> to state whether your sound object refers to a BGM or a sound effect. This function is completely optional.</p>
	      <p>Now of course, the goodies that I mentioned earlier, such as volume and looping. Let's take a look.</p>
	      <h2 class="ph3tutorialheader" id="sub5">Part 5: How do I Use and Manipulate Sound Objects?</h2>
	      <p>First we will discuss how to play sound objects. You use <span class="tooltip" onmouseover="getFxnDocs('ObjSound_Play', 'f_osoundp_01');"><code>ObjSound_Play()</code><span class="tooltiptext" id="f_osoundp_01"></span></span>, <span class="tooltip" onmouseover="getFxnDocs('ObjSound_Stop', 'f_osounds_01');"><code>ObjSound_Stop()</code><span class="tooltiptext" id="f_osounds_01"></span></span>, and <span class="tooltip" onmouseover="getFxnDocs('ObjSound_IsPlaying', 'f_osoundip_01');"><code>ObjSound_IsPlaying()</code><span class="tooltiptext" id="f_osoundip_01"></span></span> to control sound objects. <span class="tooltip" onmouseover="getFxnDocs('ObjSound_SetFade', 'f_osoundsf_01');"><code>ObjSound_SetFade()</code><span class="tooltiptext" id="f_osoundsf_01"></span></span> can be used to fade the sound rather than abruptly stopping it.</p>
	      <p>If you want to play a sound object with a given volume, then use <span class="tooltip" onmouseover="getFxnDocs('ObjSound_SetVolumeRate', 'f_osoundsvr_01');"><code>ObjSound_SetVolumeRate()</code><span class="tooltiptext" id="f_osoundsvr_01"></span></span>. The volume goes from 0 to 100 linearly. It used to be exponential but this was changed. It is highly recommended that all your sound effects be around the same volume, as you will most likely want to use the same function for creating all of them. As for Pan Rate, controlled by <span class="tooltip" onmouseover="getFxnDocs('ObjSound_SetPanRate', 'f_osoundspr_01');"><code>ObjSound_SetPanRate()</code><span class="tooltiptext" id="f_osoundspr_01"></span></span>, you can control which earbud/side you want the sound to go to, with -100 being all to the left side and 100 to all on the right side. This is used in cases such as the warp sound effects in Subterranean Animism, where all of the sound effect goes to one ear and not the other. For most cases, you will never use this function, but it exists.</p>
	      <p>Now it is time to talk about looping. Sound objects by default do not loop. You must use <span class="tooltip" onmouseover="getFxnDocs('ObjSound_SetLoopEnable', 'f_osoundsle_01');"><code>ObjSound_SetLoopEnable()</code><span class="tooltiptext" id="f_osoundsle_01"></span></span> to allow a track to loop. After this, there are two main methods for how to loop - by time, and by sample.</p>
	      <p>To loop by time, use <span class="tooltip" onmouseover="getFxnDocs('ObjSound_SetLoopTime', 'f_osoundslt_01');"><code>ObjSound_SetLoopTime()</code><span class="tooltiptext" id="f_osoundslt_01"></span></span>. For example, let's say that I have a music track where the loop starts at 5.43 seconds and the loop ends at 85.43 seconds. I will use the following to loop it:</p>
	      <pre class="prettyprint linenums"><code>    function CreateTrack{
	let obj = ObjSound_Create();
	ObjSound_Load(obj, GetCurrentScriptDirectory() ~ "./bgm/clownpiece.ogg");
	ObjSound_SetSoundDivision(obj, SOUND_BGM);
	ObjSound_SetLoopEnable(obj, true);
	ObjSound_SetLoopTime(obj, 5.43, 85.43);
	return obj;
    }</code></pre>
	      <p>When it plays, it will play from the beginning, and once it hits the 85.43 second mark, it will go to the 5.43 second mark and continue playing from there. Any parts of the BGM after 85.43 seconds will not be played unless the loop time is changed. If the end loop time is greater than the length of the song, the song will return to the 5.43 second mark as soon as the entire track finishes - there will not be a period with no sound.</p>
	      <p>Samples are another way to loop tracks. For getting the sample counts, you must ask the composer or you must manually find them yourself using a tool such as Audacity. Loops work in a similar way, except that you use <span class="tooltip" onmouseover="getFxnDocs('ObjSound_SetLoopSampleCount', 'f_osoundslsc_01');"><code>ObjSound_SetLoopSampleCount()</code><span class="tooltiptext" id="f_osoundslsc_01"></span></span> instead.</p>
	      <p>To end this lesson, I will discuss restarting tracks using <span class="tooltip" onmouseover="getFxnDocs('ObjSound_SetRestartEnable', 'f_osoundsre_01');"><code>ObjSound_SetRestartEnable()</code><span class="tooltiptext" id="f_osoundsre_01"></span></span>. Easily the most frustrating function in the entire sound object section, it will, if set to true, restart the song from the very start if the sound object is stopped and restarted later. Otherwise the song will continue from where it left off when <span class="tooltip" onmouseover="getFxnDocs('ObjSound_Play', 'f_osoundp_02');"><code>ObjSound_Play()</code><span class="tooltiptext" id="f_osoundp_02"></span></span> is called. Combined with looping and stopping and playing and restarting, this function can be a royal pain to figure out, but it's quite useful if you need it. It is, however, an optional function. Don't use it unless you need it.</p>
	      <p>For future reference, I will be providing a sound effect library for public use here: <a target="_blank" href="https://github.com/TheLandOfCodesAndApertures/Sparen_Sound_Library">Sparen's Sound Library</a>. I suggest that you look at the tasks used to create the sound objects, and perhaps use them as a reference when creating your own.</p>
	      <div class="tut_exercise">EXERCISE: Implement your own sound object for bgm. Experiment with the various functions. What happens when you play two sound objects that are both set to bgm at the same time? SFX?</div>
	      <h2 class="ph3tutorialheader" id="quiz1">Quiz: Sounds in Danmakufu</h2>
	        <!--Quiz start.-->
		<p>1) Junko wants her music to be as pure as possible. To ensure this, she wants her bgm to be recognized by Danmakufu as a BGM. How should she do this?</p>
	        <form method="POST" onSubmit="return checkAnswerP(this, 'C', 4);">
	        <input type="RADIO" value="A" name="cc">
	        A. ObjSound_SetSoundDivision(SOUND_BGM);<br>
	        <input type="RADIO" value="B" name="cc">
	        B. ObjSound_SetSoundDivision(SOUND_SE);<br>
	        <input type="RADIO" value="C" name="cc">
	        C. ObjSound_SetSoundDivision(obj, SOUND_BGM);<br>
	        <input type="RADIO" value="D" name="cc">
	        D. ObjSound_SetSoundDivision(obj, SOUND_MUSIC);<br>
	        <input type="SUBMIT" value="Submit">
	        </form>
		<br>
		<p>2) Ringo is busy eating dango when she realizes that the music playing in Danmakufu suddenly jumped to a point in the middle of the song. What could have happened? Her code is below:</p>
	      <pre class="prettyprint"><code>    ObjSound_SetLoopTime(obj, 27, 85); //not the actual loop points of Pumpkin of September, sorry</code></pre>
	        <form method="POST" onSubmit="return checkAnswerP(this, 'C', 5);">
	        <input type="RADIO" value="A" name="cc">
	        A. Her start point in the loop (27) is incorrect and should be lower<br>
	        <input type="RADIO" value="B" name="cc">
	        B. Her end point in the loop (85) is incorrect and should be higher<br>
	        <input type="RADIO" value="C" name="cc">
	        C. The bgm is shorter than one minute and 25 seconds<br>
	        <input type="SUBMIT" value="Submit">
	        </form>
	      <h2 class="ph3tutorialheader" id="sub6">Part 6: How Can I Use Audacity to Export to .ogg?</h2>
	      <p>In this tutorial, I've mentioned Audacity a lot, but for good reason. It's a free piece of open-source software that has all kinds of audio manipulation features. You can add effects, new tracks, and all kinds of stuff, or you can simply use it for looping music or exporting between different file types.</p>
	      <p>Since Audacity is a must-have for all Danmakufu scripter (and video game designers, to an extent), you should definitely get it and be familiar with how to use it. The official website is <a href="http://www.audacityteam.org" target="_blank">here</a> and you can download the software here as well.</p>
	      <p>Anyways, I'll only go over exporting to .ogg here. First, open your .mp3/.wav/whatever sound file in Audacity. Then go to File -> Export Audio. Under file type, select OGG Vorbis. And then save! You're done.</p>
	      <p>As stated previously, .ogg files are vastly better when you need to loop music tracks in Danmakufu, so Audacity is a helpful tool.</p>
	      <p></p>
	      <h2 class="ph3tutorialheader" id="subs">Summary</h2>
	        <ul>
	          <li>You must Load a sound before it can be played.</li>
	          <li>Different file types have different types and advantages - .ogg is best for BGM and .wav is best for Sound Effects</li>
	          <li>Sound Objects can be customized to loop, have volume rates and pan rates, and more</li>
	        </ul>
	      <h2 class="ph3tutorialheader" id="subf">Sources and External Resources</h2>
	      <p>N/A</p>
	      <br>            </div>          </div>
          <div class="tutnavbar">
	    <ul>
	      <li><a href="./ph3u2l14.html" title="Sparen's Danmakufu ph3 Tutorials - Utilizing Blend Types in Danmakufu">Unit 2 Lesson 14</a></li>
	      <li><span>Navigation Bar</span></li>
	      <li><a href="./ph3u2l16.html" title="Sparen's Danmakufu ph3 Tutorials - Object Autodeletion and (0,0) Spawning">Unit 2 Lesson 16</a></li>
	    </ul>
	    <br>
          </div>        </div>      </div>      <footer id="footer">      </footer>    </div>
    <script type="text/javascript" src="javascript/ph3tutorialcommon.js"></script>
    <script type="text/javascript" src="javascript/GenericQuiz.js"></script>
    <script type="text/javascript" src="javascript/QReviewP.js"></script>
    <link href="customhighlighter/desert.css" type="text/css" rel="stylesheet" />
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <script type="text/javascript" src="javascript/dnhdocs_standard.js"></script>
    <script type="text/javascript" src="javascript/dnhdocs_object.js"></script>
    <script type="text/javascript" src="javascript/dnhdocs_system.js"></script>
    <script type="text/javascript" src="javascript/dnhdocs.js"></script>  </body></html>