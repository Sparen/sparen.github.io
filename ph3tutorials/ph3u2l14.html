<!DOCTYPE html><html lang="en-us">  <head>    <meta charset="utf-8">    <title>AFCDTech - Sparen's Danmakufu ph3 Tutorials - Lesson 14</title>    <link rel="stylesheet" type="text/css" href="../blah.css">    <meta content="Sparen's Danmakufu ph3 Tutorials Lesson 14 - Utilizing Blend Types in Danmakufu. A guide to understanding and using Blend Types in Touhou Danmakufu ph3."      name="description">
    <meta name="keywords" content="Sparen, Touhou, Danmakufu, ph3, Tutorial, Script, Danmaku, Plural, Boss, Sprite, Primitive">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-58194930-1', 'auto');
    ga('send', 'pageview');
  </script>  </head>  <body id="mhome">    <div class="yui-t1" id="top">      <p style="text-align: center;"><a href="http://sparen.github.io"><img alt="Site Logo" src="../images/logo.png" style="width:100%;max-width:1000px"></a></p>      <br>      <div id="menubar">
        <ul>
          <li><a class="mhome" href="http://sparen.github.io" title="AFCDTech">Return to Home</a></li>
          <li><a class="mph3tutorials" href="./ph3tutorials.html" title="Sparen's Danmakufu ph3 Tutorials">ph3 Tutorial Index</a></li>
          <li><a class="mdnhwiki" target="_blank" href="http://dmf.shrinemaiden.org/wiki/Main_Page">Danmakufu Wiki</a></li>
          <li><a class="mph3functionlist" target="_blank" href="http://dmf.shrinemaiden.org/wiki/Functions_(ph3)">Ph3 Function List</a></li>
        </ul>
      </div>      <div id="bd">        <div id="yui-main">          <div class="yui-b">
            <div class="tutnavbar">
  	      <ul>
	        <li><a href="./ph3u2l13.html" title="Sparen's Danmakufu ph3 Tutorials - Introduction to 2D Sprites">Unit 2 Lesson 13</a></li>
	        <li>Navigation Bar</li>
	        <li><a href="./ph3u2l15.html" title="Sparen's Danmakufu ph3 Tutorials - Using Danmakufu's Sound Functions">Unit 2 Lesson 15</a></li>
	      </ul>
            </div>            <div class="yui-g">	      <h1 style="color:orange">Sparen's Danmakufu ph3 Tutorials Lesson 14 - Utilizing Blend Types in Danmakufu</h1>	      <p>The video for this lesson is Conarnar's Youmu! The second nonspell takes full advantage of one of the blend properties of lasers to create a very unique nonspell experience, and this is just one of the many ways in which it is possible to use blend types for graphical effect.</p>
	      <!--Embedded video below. Make sure to format the link correctly-->
	      <embed width="420" height="315"
		src="https://www.youtube.com/v/MSKxdNh9E4A">
	      <div class="tutorialnav">
	        <h2 style="color:aqua">Table of Contents</h2>
	        <ul>
	          <li><a href="#sub1">Part 1: What will be Covered in this Lesson?</a></li>
	          <li><a href="#sub2">Part 2: What are the Blend Types in Danmakufu ph3?</a></li>
	          <li><a href="#sub3">Part 3: What is Alpha Compositing and How is it Used?</a></li>
	          <li><a href="#sub4">Part 4: What is Additive Blending and How is it Used?</a></li>
	          <li><a href="#sub5">Part 5: What is Subtractive Blending and How is it Used?</a></li>
	          <li><a href="#sub6">Part 6: What is Multiplicative Blending and How is it Used?</a></li>
	          <li><a href="#sub7">Part 7: What is Invert and How is it Used?</a></li>
	          <li><a href="#quiz1">Quiz: Blend Types</a></li>
	          <li><a href="#subs">Summary</a></li>
	          <li><a href="#subf">Sources and External Resources</a></li>
	        </ul>
	      </div>	      <h2 style="color:yellow" id="sub1">Part 1: What will be Covered in this Lesson?</h2>
	      <p>Back in <a href="./ph3u1l8.html">Lesson 8</a>, I talked about blend types in terms of shotsheets. Today I will go significantly more in depth and explain various uses of the various blend types, as well as what they do.</p>
	      <h2 style="color:yellow" id="sub2">Part 2: What are the Blend Types in Danmakufu ph3?</h2>
	      <p>Firstly, what are the blend types present in Danmakufu? Well, there is, of course, the default - Alpha. Then there are two forms of Additive Blending - BLEND_ADD_RGB and BLEND_ADD_ARGB. There are also Multiplicative and Subtractive blends. Also available is Invert, which is commonly abused due to its effects.</p>
	      <p>You can use <code>ObjRender_SetBlendType()</code> to change blend types.</p>
	      <p>As of ph3 [.1 pre6a], there is also a BLEND_SHADOW, which is not documented. I unfortunately have not tried this and do not know the proper name for it - it could be darken, divide, difference, overlay, etc. I will update this when it is known or when it is included in the documentation.</p>
	      <h2 style="color:yellow" id="sub3">Part 3: What is Alpha Compositing and How is it Used?</h2>
	      <p>I'll begin with the simplest 'blend' - Alpha. This is the default and renders the image the exact same way as any graphical editor. Transparency is maintained if present.</p>
	      <p>From a technical standpoint, Alpha Compositing involves taking the image in question and merging it with the background below (for Danmakufu, that means anything with a lower render priority or any object with the same render priority that was created prior).</p>
	      <p>The applications of BLEND_ALPHA are numerous. Almost everything in Danmakufu is rendered with it. Most graphics will be rendered using Alpha, and the usage of transparency allows for extremely detailed effects that meld with the backgrounds they are on.</p>
	      <h2 style="color:yellow" id="sub4">Part 4: What is Additive Blending and How is it Used?</h2>
	      <p>Of the simple arithmetic blend modes, Additive Blending sees the most use in Danmakufu. It adds the pixel values of one layer with the other. This always results in a brighter image. For example, you are rendering one image on top of a background. The pixel values of the image and background underneath will add, resulting in a shinier image.</p>
	      <p>In Danmakufu, there are two ways to use Additive Blending. One involves a black background - BLEND_ADD_RGB. Everything that is pure black becomes transparent, and everything else becomes shiny. Most bubble bullets and fireball bullets are rendered with ADD because it makes them very shiny and nice to look at, especially when contrasted with a dark background or playing field. Additionally, lasers are rendered by default using BLEND_ADD_RGB.</p>
	      <p>The other type of Additive Blending is BLEND_ADD_ARGB. Instead of black, you use a partially transparent object. The level of transparency will dictate the level of shininess that results.</p>
	      <p>Note that when using <code>ObjRender_SetAlpha()</code>, ADD_RGB ignores it and will always display the image the same way, while with ADD_ARGB, the alpha of the image in Danmakufu will change the level of shininess of the image.</p>
	      <div class="tut_exercise">EXERCISE: Render some images with Additive Blending. What kind of images work best? Does ADD_ARGB work better? Worse?</div>
	      <h2 style="color:yellow" id="sub5">Part 5: What is Subtractive Blending and How is it Used?</h2>
	      <p>In contrast to Additive Blending, Subtractive Blending sees limited usage in Danmakufu, being used mainly for graphical effect. It does the exact opposite as Additive Blending, always darkening the image. If the values end up being negative, black is displayed instead. Subtractive Blending is excellent when used on fog and partially transparent images.</p>
	      <h2 style="color:yellow" id="sub6">Part 6: What is Multiplicative Blending and How is it Used?</h2>
	      <p>Multiplicative blending is great for darkening images, but has limited use in Danmakufu - mainly for graphical effect. It multiplies the pixel value of the top layer with that of the bottom layer, darkening the image. Note that Multiply Blend in Danmakufu does not work correctly with regards to opaque/partially or wholly transparent pixels.</p>
	      <h2 style="color:yellow" id="sub7">Part 7: What is Invert and How is it Used?</h2>
	      <p>To close off the list of standard blend types in Danmakufu, we will discuss Invert, which is technically not a blend type. Black turns to white, white turns to black. Usually, this is done using a shader. But in Danmakufu, we use a specific method to control invert.</p>
	      <p>Most of the time, we use a pure white circle or square on a transparent background. We set the blend type of this circle or square to BLEND_INV_DESTRGB. Now, anything rendered below this circle will have its color inverted. Applying two objects with invert, one on top of the other, will negate the effect.</p>
	      <p>The invert effect is pretty cool, but is also used in situations where it is not optimal. For best usage, a high contrast background or scene should be used to give maximum effect to the invert.</p>
	      <p>For example:</p>
	      <pre class="prettyprint linenums"><code>    task Invert{
        let invert = GetCurrentScriptDirectory() ~ "./img/inv_circle.png"; //Define path
        let objInv = ObjPrim_Create(OBJ_SPRITE_2D);
        let objcount = 0;
        ObjPrim_SetTexture(objInv, invert);
        ObjSprite2D_SetSourceRect(objInv, 0, 0, 512, 512);
        ObjSprite2D_SetDestCenter(objInv);
        ObjRender_SetScaleXYZ(objInv, 0.25, 0.25, 1);
        ObjRender_SetPosition(objInv, 384/2, 448/2, 1);
        ObjRender_SetBlendType(objInv, BLEND_INV_DESTRGB);
        while(ObjEnemy_GetInfo(objBoss,INFO_LIFE) > 0){
            ObjRender_SetScaleXYZ(objInv, 0.25 + 0.1*sin(objcount*3), 0.25 + 0.1*sin(objcount*3), 1);
            objcount++;
            yield;
        }
        Obj_Delete(objInv);
    }</code></pre>
	      <p>The above code creates an invert object at the center of the screen whose size oscillates with time. Depending on how you want to use it, Invert can be a powerful tool.</p>
	      <h2 style="color:yellow" id="quiz1">Quiz: Blend Types</h2>
	        <!--Quiz start.-->
		<p>1) For a shiny image, which blend type would we use?</p>
	        <form method="POST" onSubmit="return checkAnswerP(this, 'A', 4);">
	        <input type="RADIO" value="A" name="cc">
	        A. BLEND_ADD_ARGB<br>
	        <input type="RADIO" value="B" name="cc">
	        B. BLEND_SHADOW <br>
	        <input type="RADIO" value="C" name="cc">
	        C. BLEND_SUBTRACT <br>
	        <input type="SUBMIT" value="Submit">
	        </form>
		<br>
		<p>2) Seija wants to invert everything. Specifically, she wants to invert the entire STG_Frame. How would she do this?</p>
		<form>
	        <input type="text" size="100" value="Type answer here and click 'Show' to see answer">
		</form>
	        <input class="spoilerbutton" type="button" value="Show" onclick="this.value=this.value=='Show'?'Hide':'Show';">
		<div class="spoiler"><div>
		<p>The best way to do this is to have a white square texture, and create a 2D Sprite of this object. The render priority would be 99 in order to cover everything on the STG_Frame, such as the text. The blend would be BLEND_INV_DESTRGB, and the object would be centered at (320, 240), stretched to fit the screen.</p>
	      <pre class="prettyprint"><code>    task Invert{
	let invert = GetCurrentScriptDirectory~"./img/inv_square.png"; //Define path
	let objInv = ObjPrim_Create(OBJ_SPRITE_2D);
	let objcount = 0;
	ObjPrim_SetTexture(objInv, invert);
	ObjSprite2D_SetSourceRect(objInv, 0, 0, 512, 512);
	ObjSprite2D_SetDestRect(objInv, -320, -240, 320, 240);
	ObjRender_SetPosition(objInv, 640/2, 480/2, 1);
	ObjRender_SetBlendType(objInv, BLEND_INV_DESTRGB);
	Obj_SetRenderPriorityI(objInv, 99);
    }</code></pre>
	        </div></div>
	      <h2 style="color:yellow" id="subs">Summary</h2>
	        <ul>
	          <li>Additive Blending is good for making graphics shiny</li>
	          <li>Subtractive Blending is good for making graphics dark</li>
	          <li>Invert can be used to flip the RGB values of whatever is rendered below an INV_DESTRGB object</li>
	        </ul>
	      <h2 style="color:yellow" id="subf">Sources and External Resources</h2>
	      <p>N/A</p>
	      <br>            </div>          </div>
          <div class="tutnavbar">
	    <ul>
	      <li><a href="./ph3u2l13.html" title="Sparen's Danmakufu ph3 Tutorials - Introduction to 2D Sprites">Unit 2 Lesson 13</a></li>
	      <li>Navigation Bar</li>
	      <li><a href="./ph3u2l15.html" title="Sparen's Danmakufu ph3 Tutorials - Using Danmakufu's Sound Functions">Unit 2 Lesson 15</a></li>
	    </ul>
	    <br>
          </div>        </div>      </div>      <footer>
        <p style="text-align: center;">Last Update to Page: Oct 19, 2015</p>        <p style="text-align: center;"><a href="#top">Top</a></p>        <p style="text-align: center;">Copyright © 2014-2015 by Andrew Fan</p>        <p style="text-align: center;"><span style="font-weight: bold;">Other            Sites/Affiliates</span></p>        <div style="text-align: center;"><a target="_blank" href="http://www.winehq.org"><img	      alt="&quot;Wine HQ&quot;"	      src="../images/afflogowinehq.png"></a>          <a target="_blank" href="http://www.shrinemaiden.org/forum/index.php"><img	      alt="&quot;Maidens of the Kaleidoscope&quot;"	      src="../images/afflogomotk.png"></a>          <a target="_blank" href="http://www.bulletforge.org"><img alt="&quot;Bulletforge&quot;"	      src="../images/afflogobulletforge.png"></a>          <a target="_blank" href="http://moriyashrine.weebly.com/index.html"><img	      alt="&quot;Moriya Shrine&quot;"	      src="../images/afflogomoriyashrine.png"></a>        </div>
        <div style="text-align: center;"><br>
          <p><b>ADVERTISEMENTS</b></p>
          <p>Hey scripters! Want me to feature your script/project/blog/website/Youtube video down here?</p>
          <p>Read <a href="../advertisements.html">this page</a> for more information.</p><br>
        </div>      </footer>    </div>
    <script type="text/javascript" src="javascript/GenericQuiz.js"></script>
    <script type="text/javascript" src="javascript/QReviewP.js"></script>
    <link href="customhighlighter/desert.css" type="text/css" rel="stylesheet" />
    <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js?lang=c"></script>  </body></html>