<!DOCTYPE html><html lang="en-us">  <head>    <meta charset="utf-8">    <title>AFCDTech - Sparen's Danmakufu ph3 Tutorials - Extra Lesson 1</title>    <link rel="stylesheet" type="text/css" href="../blah.css">
    <link rel="stylesheet" type="text/css" href="docs.css">    <meta content="Sparen's Danmakufu ph3 Tutorials Extra Lesson 1 - Recollection: Eternal Meek. A guide to understanding the usage of rand in Touhou Danmakufu ph3."      name="description">
    <meta name="keywords" content="Sparen, Touhou, Danmakufu, ph3, Tutorial, Script, Danmaku, Bullet, Shot, Random">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-58194930-1', 'auto');
    ga('send', 'pageview');
  </script>  </head>  <body onload="setupENG('May 1, 2018')">    <div class="yui-t1" id="top">      <p style="text-align: center;"><a href="https://sparen.github.io"><img alt="Site Logo" src="../images/logo.png" style="width:100%;max-width:1000px"></a></p>      <br>      <div id="menubar">
        <ul>
          <li><a class="mhome" href="https://sparen.github.io" title="AFCDTech">Return to Home</a></li>
          <li><a class="mph3tutorials" href="./ph3tutorials.html" title="Sparen's Danmakufu ph3 Tutorials">ph3 Tutorial Index</a></li>
          <li><a class="mdnhwiki" target="_blank" href="http://dmf.shrinemaiden.org/wiki/Main_Page">Danmakufu Wiki</a></li>
          <li><a class="mph3functionlist" target="_blank" href="http://dmf.shrinemaiden.org/wiki/Functions_(ph3)">Ph3 Function List</a></li>
        </ul>
      </div>      <div id="bd">        <div id="yui-main">          <div class="yui-b">
            <div class="tutnavbar">
	      <ul>
	        <li><a href="./ph3u1l8.html" title="Sparen's Danmakufu ph3 Tutorials - Introduction to Shotsheets and Bullet Properties">Unit 1 Lesson 8</a></li>
	        <li><span>Navigation Bar</span></li>
	        <li><a href="./ph3u1l9.html" title="Sparen's Danmakufu ph3 Tutorials - Introduction to Lasers">Unit 1 Lesson 9</a></li>
	      </ul>
            </div>            <div class="yui-g">	      <h1 class="toplevelheadera">Sparen's Danmakufu ph3 Tutorials Extra Lesson 1 - Recollection: Eternal Meek</h1>	      <p>The video for this lesson (and all extra lessons) is a video of the spell we will be replicating. In this case, it is, as you have probably realized by now, Eternal Meek, Sakuya's <s>signature spell</s>.</p>
	      <!--Embedded video below. Make sure to format the link correctly-->
	      <div class="ytembed_sm">
	        <iframe src="https://www.youtube.com/embed/sErv3ZH6AcQ" frameborder="0" allowfullscreen></iframe>
	      </div>
	      <div class="tutorialnav">
	        <h2 style="color:aqua">Table of Contents</h2>
	        <ul>
	          <li><a href="#sub1">Part 1: What will be Covered in this Lesson?</a></li>
	          <li><a href="#sub2">Part 2: How do I use rand?</a></li>
	          <li><a href="#sub3">Part 3: What Functions Can I Use to Truncate Floats?</a></li>
	          <li><a href="#sub4">Part 4: How do I Write My Own rand_int?</a></li>
	          <li><a href="#sub5">Part 5: What are the Uses of rand_int?</a></li>
	          <li><a href="#quiz1">Quiz: rand_int</a></li>
	          <li><a href="#sub6">Part 6: How do I Replicate Eternal Meek?</a></li>
	          <li><a href="#subf">Sources and External Resources</a></li>
	        </ul>
	      </div>	      <h2 class="ph3tutorialheader" id="sub1">Part 1: What will be Covered in this Lesson?</h2>
	      <p>In this lesson, I will be explaining the usage of rand in greater detail, how to recreate rand_int, how to index arrays using rand, and will show, step by step, the components of Eternal Meek and how we can replicate it.</p>
	      <h2 class="ph3tutorialheader" id="sub2">Part 2: How do I use rand?</h2>
	      <p>We've used rand before. You give rand two numbers - these are your bounds. <span class="tooltip" onmouseover="getFxnDocs('rand', 'f_rand_01');"><code>rand()</code><span class="tooltiptext" id="f_rand_01"></span></span> will generate a floating point number between these (it will, for practical purposes, never be an integer). Note that regardless of whether or not the bounds are included, it is nearly impossible to get exactly those bounds, so always use <span class="tooltip" onmouseover="getFxnDocs('rand', 'f_rand_02');"><code>rand()</code><span class="tooltiptext" id="f_rand_02"></span></span> assuming that the result will have a multitude of numbers after a decimal point.</p>
	      <h2 class="ph3tutorialheader" id="sub3">Part 3: What Functions Can I Use to Truncate Floats?</h2>
	      <p>We will be creating a function called rand_int shortly, but before we do this, we must discuss the various built-in ways to truncate floating point numbers (anything with a decimal point) to integers in Touhou Danmakufu ph3. Our main reference will be <a target="_blank" href="http://dmf.shrinemaiden.org/wiki/Math_Functions" title="Math Functions for Touhou Danmakufu ph3">Math Functions</a>.</p>
	      <p>The first function we will look at is <span class="tooltip" onmouseover="getFxnDocs('round', 'f_round_01');"><code>round()</code><span class="tooltiptext" id="f_round_01"></span></span>. This function will round the decimal to the nearest integer using standard rules. Anything .5 or greater will round up, anything less than .5 will round down.</p>
	      <pre class="prettyprint"><code>round(0.006);     //0
round(3.500);     //4
round(4.566);     //5
round(6.246);     //6
round(-1.836);    //-2
round(-9.496);    //-9</code></pre>
	      <p>The second function we will look at is <span class="tooltip" onmouseover="getFxnDocs('truncate', 'f_truncate_01');"><code>truncate()</code><span class="tooltiptext" id="f_truncate_01"></span></span>. This function will slice off the decimal place, leaving the integer component only. It can also be referred to as <code>trunc()</code></p>
	      <pre class="prettyprint"><code>truncate(0.006);     //0
truncate(3.500);     //3
trunc(4.566);        //4
trunc(6.246);        //6
truncate(-1.836);    //-1
round(-9.496);       //-9</code></pre>
	      <p>The third function we will look at is <span class="tooltip" onmouseover="getFxnDocs('ceil', 'f_ceil_01');"><code>ceil()</code><span class="tooltiptext" id="f_ceil_01"></span></span>, short for ceiling. This function will always round up. Think of a number line - ceil will return the next integer to the right.</p>
	      <pre class="prettyprint"><code>ceil(0.006);     //1
ceil(3.500);     //4
ceil(4.566);     //5
ceil(6.246);     //7
ceil(-1.836);    //-1
ceil(-9.496);    //-9</code></pre>
	      <p>The last function we will look at is <span class="tooltip" onmouseover="getFxnDocs('floor', 'f_floor_01');"><code>floor()</code><span class="tooltiptext" id="f_floor_01"></span></span>, which is similar to ceiling. This function will always round down. Think of a number line - ceil will return the next integer to the left.</p>
	      <pre class="prettyprint"><code>floor(0.006);     //0
floor(3.500);     //3
floor(4.566);     //4
floor(6.246);     //6
floor(-1.836);    //-2
floor(-9.496);    //-10</code></pre>
	      <p>Now that we have these, we will create <code>rand_int()</code>.</p>
	      <h2 class="ph3tutorialheader" id="sub4">Part 4: How do I Write My Own rand_int?</h2>
	      <p>The function of rand_int() is to return a random integer in between two bounds, inclusive. To do this, which of the four functions should we use?</p>
	      <p>Of the four, trunc, ceil, and floor all exclude one or both of the bounds. Therefore, the only option here is to use <span class="tooltip" onmouseover="getFxnDocs('round', 'f_round_02');"><code>round()</code><span class="tooltiptext" id="f_round_01"></span></span>. So how exactly would we go about making this function?</p>
	      <p>Let's start with the skeleton. We have a function that takes in two integer parameters and returns an integer. So let's write an empty function.</p>
	      <pre class="prettyprint"><code>function rand_int(min, max){

}</code></pre>
	      <p>Of course, nothing will happen if we run this function, and using it assuming it will return something will result in an error. So we need the contents of the function.</p>
	      <p>Our aim is to use round with the two bounds to obtain a random integer between the two bounds, inclusive. And of course... we can use rand! A completed <code>rand_int()</code> is presented below.</p>
	      <pre class="prettyprint"><code>function rand_int(min, max){
  return round(rand(min, max))
}</code></pre>
	      <p>This works by first running <span class="tooltip" onmouseover="getFxnDocs('rand', 'f_rand_03');"><code>rand()</code><span class="tooltiptext" id="f_rand_03"></span></span>. This obtains a floating point value between the two bounds, and then runs <span class="tooltip" onmouseover="getFxnDocs('round', 'f_round_03');"><code>round()</code><span class="tooltiptext" id="f_round_03"></span></span> on it, turning it into an integer.</p>
	      <p>Note that using <code>round(rand(min, max))</code> results in a bias against the first and last numbers. Alternate and perhaps more effective ways to implement rand_int include <code>truncate(rand(min, max + 1))</code>, etc.</p>
	      <p>Of course, what are the uses of rand_int?</p>
	      <h2 class="ph3tutorialheader" id="sub5">Part 5: What are the Uses of rand_int?</h2>
	      <p>rand_int is used whenever you need a random integer. This often happens when you want a specific graphic in a range - you can use <code>rand_int(min, max)</code> to obtain a random integer between min and max inclusive.</p>
	      <p>But let's say you don't want the one in the middle. For example, you want 30-36, but not 33. How could you do this? Well, rand_int provides a solution. Remember that you index arrays starting from 0 and then incrementing from there. So we can do the following!</p>
	      <pre class="prettyprint"><code>let graphic = [30, 31, 32, 34, 35, 36][rand_int(0, 5)];</code></pre>
	      <p>The above code will create an array with [30, 31, 32, 34, 35, 36], and will then index that array using the [rand_int(0, 5)]. The rand_int will spit out an integer between 0 (corresponding to 30) and 5 (corresponding to 36). This is a nifty trick that you may consider using. (Credits to Infinite Ultima Wave for teaching me that this exists)</p>
	      <h2 class="ph3tutorialheader" id="quiz1">Quiz: rand_int</h2>
	        <!--Quiz start.-->
		<p>1) Let's say we run <code>rand_int(0, 50)</code>. Which of the following is not a possible result?</p>
	        <form method="POST" onSubmit="return checkAnswerGENERIC(this, 'B');">
	        <input type="RADIO" value="A" name="cc">
	        A. 50<br>
	        <input type="RADIO" value="B" name="cc">
	        B. 4.5<br>
	        <input type="RADIO" value="C" name="cc">
	        C. 30<br>
	        <input type="RADIO" value="D" name="cc">
	        D. 0<br>
	        <input type="RADIO" value="E" name="cc">
	        E. 12<br>
	        <input type="SUBMIT" value="Submit">
	        </form>
		<br>
		<p>2) What is a possible output of <code>trunc(absolute(rand(-60, 60)));</code></p>
	        <form method="POST" onSubmit="return checkAnswerGENERIC(this, 'C');">
	        <input type="RADIO" value="A" name="cc">
	        A. -30<br>
	        <input type="RADIO" value="B" name="cc">
	        B. 60<br>
	        <input type="RADIO" value="C" name="cc">
	        C. 59<br>
	        <input type="RADIO" value="D" name="cc">
	        D. 0.5<br>
	        <input type="SUBMIT" value="Submit">
	        </form>
	      <h2 class="ph3tutorialheader" id="sub6">Part 6: How do I Replicate Eternal Meek?</h2>
	      <p>So it's finally time for the main show - Eternal Meek! We will begin with an analysis of the spellcard.</p>
	      <p>The first thing to note is that this 13 second spell has Sakuya stationary in one location. This means that there will be no movement at all during the attacking. The next thing to note is that the bullets are all spawned from directly on top of her position with a high delay. This will inform the player to beware of faster bullets, and indeed, the bullet speeds are fast.</p>
	      <p>Based on how often the SFX plays, it is safe to assume that there is a bullet every frame, or a bullet every two frames. This allows us to formulate our MainTask, which we will call once at the end of @Initialize. For the purposes of our replica, we will have one bullet per frame.</p>
	      <pre class="prettyprint linenums"><code>task MainTask{
    ObjMove_SetDestAtFrame(objBoss, GetCenterX(), 60, 60)
    wait(120);
    while(ObjEnemy_GetInfo(objBoss, INFO_LIFE) > 0){
	//We will be inserting the bullet spawning here.
	yield;
    }
}</code></pre>
	      <p>In the above code, I have set her position to GetCenterX(), 60. This may not be the actual position, but it should do for now. I have also put in a 60 frame delay from the end of the movement to the start of the actual bullet spawning. Now, for the actual bullet spawning.</p>
	      <p>Each bullet has the same graphic and has the same starting position, but has a different angle and speed. Therefore, we will use rand(0,360) for the angle and rand(3,6) for the speed. For all practical purposes, speeds of 2 and below are slow, 2-4 are moderate, and anything over 4 usually requires a delay laser or for the speed of the bullet to be obvious. In the case of Eternal Meek, the large delay clouds and the occurrence of the spell late in the game help justify the presence of bullets with such high speeds.</p>
	      <p>Now that we have our arguments prepared, we can fill in our code.</p>
	      <pre class="prettyprint linenums"><code>task MainTask{
    ObjMove_SetDestAtFrame(objBoss, GetCenterX(), 60, 60)
    wait(120);
    while(ObjEnemy_GetInfo(objBoss, INFO_LIFE) > 0){
	CreateShotA1(ObjMove_GetX(objBoss), ObjMove_GetY(objBoss), rand(3, 6), rand(0, 360), DS_BALL_S_BLUE, 20);
	yield;
    }
}</code></pre>
	      <p>And there we have it - Eternal Meek, the easiest spellcard to replicate in all of Touhou.</p>
	      <h2 class="ph3tutorialheader" id="subf">Sources and External Resources</h2>
	      <p>N/A</p>
	      <br>            </div>          </div>
          <div class="tutnavbar">
	    <ul>
	      <li><a href="./ph3u1l8.html" title="Sparen's Danmakufu ph3 Tutorials - Introduction to Shotsheets and Bullet Properties">Unit 1 Lesson 8</a></li>
	      <li><span>Navigation Bar</span></li>
	      <li><a href="./ph3u1l9.html" title="Sparen's Danmakufu ph3 Tutorials - Introduction to Lasers">Unit 1 Lesson 9</a></li>
	    </ul>
	    <br>
          </div>        </div>      </div>      <footer id="footer">      </footer>    </div>
    <script type="text/javascript" src="javascript/ph3tutorialcommon.js"></script>
    <script type="text/javascript" src="javascript/GenericQuiz.js"></script>
    <script type="text/javascript" src="javascript/QReviewP.js"></script>
    <link href="customhighlighter/desert.css" type="text/css" rel="stylesheet" />
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=c"></script>
    <script type="text/javascript" src="javascript/dnhdocs_standard.js"></script>
    <script type="text/javascript" src="javascript/dnhdocs_object.js"></script>
    <script type="text/javascript" src="javascript/dnhdocs_system.js"></script>
    <script type="text/javascript" src="javascript/dnhdocs.js"></script>  </body></html>