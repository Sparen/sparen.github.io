<!DOCTYPE html><html lang="en-us">  <head>    <meta charset="utf-8">    <title>AFCDTech - Sparen's Danmakufu ph3 Tutorials - Lesson 21</title>    <link rel="stylesheet" type="text/css" href="../blah.css">
    <link rel="stylesheet" type="text/css" href="docs.css">    <meta content="Sparen's Danmakufu ph3 Tutorials Lesson 21 - Customizing Replay Save Files. A guide on how to manipulate and customize Replay Save scripts."      name="description">
    <meta name="keywords" content="Sparen, Touhou, Danmakufu, ph3, Tutorial, Script, Danmaku, Plural, Boss, Single, Replay, Save">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-58194930-1', 'auto');
    ga('send', 'pageview');
  </script>  </head>  <body onload="setupENG('Mar 03, 2017')">    <div class="yui-t1" id="top">      <p style="text-align: center;"><a href="https://sparen.github.io"><img alt="Site Logo" src="../images/logo.png" style="width:100%;max-width:1000px"></a></p>      <br>      <div class="docsmenubar">
        <ul>
          <li class="dmbnona"><hr>&nbsp;&nbsp;Site Navigation<hr></li>
          <li><a href="https://sparen.github.io" title="AFCDTech">Return to Home</a></li>
          <li><a href="./ph3tutorials.html" title="Sparen's Danmakufu ph3 Tutorials">ph3 Tutorial Index</a></li>
          <li><a target="_blank" href="http://dmf.shrinemaiden.org/wiki/Main_Page">Danmakufu Wiki</a></li>
          <li><a target="_blank" href="http://dmf.shrinemaiden.org/wiki/Functions_(ph3)">Ph3 Function List (DNH Wiki)</a></li>
          <li><a href="./ph3style.html" title="ph3 Style Guidelines">ph3 Style Guidelines</a></li>
          <li class="dmbnona"><hr>&nbsp;&nbsp;Function Reference<hr></li>
          <li><a href="./docs.html">Function List</a></li>
          <li><a href="./docs_standard.html">General Functions</a></li>
          <li><a href="./docs_object.html">Object Functions</a></li>
          <li><a href="./docs_system.html">Player Script Fxns</a></li>
          <li><a href="./docs_system.html">Private Script Fxns</a></li>
          <li class="dmbnona"><hr>&nbsp;&nbsp;Lesson Resources<hr></li>
        </ul>
      </div>      <div id="bd">        <div id="yui-main">          <div class="yui-b">            <div class="yui-g">
              <div class="tutnavbar">
	        <ul>
	          <li><a href="./ph3u2l20.html" title="Sparen's Danmakufu ph3 Tutorials - Manipulating Pause and End Scene Files">Unit 2 Lesson 20</a></li>
	          <li><span>Navigation Bar</span></li>
	          <li><a href="./ph3u2l22.html" title="Sparen's Danmakufu ph3 Tutorials - Implementing 2D Backgrounds in Background Files">Unit 2 Lesson 22</a></li>
	        </ul>
              </div>	      <h1 class="toplevelheadera">Sparen's Danmakufu ph3 Tutorials Lesson 21 - Customizing Replay Save Files</h1>	      <p>The video for this lesson is TresserT's Reisen. A true mind trip. Enjoy, and please Koishi appropriately.</p>
	      <!--Embedded video below. Make sure to format the link correctly-->
	      <div class="ytembed_sm">
	        <iframe src="https://www.youtube.com/embed/t6h2J6Oz11c" frameborder="0" allowfullscreen></iframe>
	      </div>
	      <div class="tutorialnav">
	        <h2 style="color:aqua">Table of Contents</h2>
	        <ul>
	          <li><a href="#sub1">Part 1: What will be Covered in this Lesson?</a></li>
	          <li><a href="#sub2">Part 2: What are Replay Save Scripts?</a></li>
	          <li><a href="#sub3">Part 3: What is inside a Replay Save Script?</a></li>
	          <li><a href="#sub4">Part 4: How do I use Custom Replay Save Scripts?</a></li>
	          <li><a href="#quiz1">Quiz: Replay Save Scripts</a></li>
	          <li><a href="#subs">Summary</a></li>
	          <li><a href="#subf">Sources and External Resources</a></li>
	        </ul>
	      </div>	      <h2 class="ph3tutorialheader" id="sub1">Part 1: What will be Covered in this Lesson?</h2>
	      <p>In this lesson, I will discuss Replay Save scripts, which are called after the user decides to save a replay in an End Scene.</p>
	      <p>You must read the previous lesson - <a href="./ph3u2l20.html">Lesson 20</a> - before starting with this tutorial, as this lesson is its logical continuation. We will assume that you are familiar with menus, manipulating text objects, and other things that have already been covered.</p>
	      <h2 class="ph3tutorialheader" id="sub2">Part 2: What are Replay Save Scripts?</h2>
	      <p>We've discussed many types of scripts already - Pause, End Scene, and so on. Reply Save screens are another integral feature that should be implemented by all scripters. Especially since the default one looks rather horrible and doesn't let you cancel out of a replay once you accidentally hit the 'Save Replay' button in the End Scene.</p>
	      <p>We set a custom Replay Save Scene in our System file with <code>SetReplaySaveSceneScriptPath()</code>, the same way as with Pause and End Scenes. This will replace the default.</p>
	      <p>The very first thing you should do is change the font. The next thing to do is change the Japanese in the strTextIn and strTextView variables to English or your language of choice (終 translates to 'end', 終了 translates to 'finished').</p>
	      <p>One thing to note, however, is the presence of brackets [ and ] in strTextIn and strTextView. Unfortunately, I highly recommend removing them and replacing them with spaces " ", because they are highly problematic (Danmakufu recognizes them as special characters, etc.). Simply remove them and add two empty spaces before your new 'End'.</p>
	      <p>Alternatively, [osb] and [csb] seem to provide the [ and ] characters, respectively if used in a string, similarly to [r]. (Thanks to Uruwi/Fluffy8x)</p>
	      <p>The reason why they work OK in the default replay save script is because strTextIn is used only for array length operations and indexing (it contains the actual characters input into your replay name), and strTextView is used exclusively for what you see displayed as the options, except that it uses a different character set to prevent bad things from happening.</p>
	      <p>Now, let's take a look at the Replay Save Script's structure, as well as how it works.</p>
	      <h2 class="ph3tutorialheader" id="sub3">Part 3: What is inside a Replay Save Script?</h2>
	      <p>The default Replay Save Scene contains a number of functions and variables to be aware of. To start, the final constants MENU_INDEX_SELECTION and MENU_NAME_ENTRY, which are used to tell the script which menu you are on (selecting a replay slot to save the replay in, or in the name entry menu).</p>
	      <p>The first of these menus is controlled via <code>TReplayIndexSelection</code>, while the latter is controlled by <code>TNameEntry</code>.</p>
	      <p><code>TReplayIndexSelection</code>, as you may have guessed, handles selecting which replay slot to save your replay in. It functions as a menu that displays various information about a replay. If you look at the individual menu items, created by <code>TMenuItem</code>, the text showed has the replay number, as well as name, date/time, and the score of the replay. These are all saved in replays by default.</p>
	      <p>Note the 'by default'. If you decide to make a full game or a rather complex stage/boss with various other features (will require a package), you can choose to display other things as well, using Replay Comments and Common Data.</p>
	      <p>Anyways, if no replay exists at a given slot, "No Data" is appended. And additionally, note that hitting right/left will allow you to access another page of replays! No, you are not limited to 10 replays per script. You can have significantly more by default in Danmakufu. The hard number is <code>REPLAY_INDEX_DIGIT_MAX - REPLAY_INDEX_DIGIT_MIN + 1</code>, which is equal to 99.</p>
	      <p><code>TNameEntry</code> is where you input your name. There are two arrays for the characters used, and using the strTextIn array, characters can be viewed and accessed, selected, and then added to your name. Here you can set the maximum name length (defaults to 8) and default name (defaults to "No Name"), and if you implement CommonData to save a player's input name, you can start out with the previously input name (you will have to implement this yourself).</p>
	      <p>Beyond these two tasks, there really isn't anything else noteworthy about a Replay Save Script. Just follow standard procedure when dealing with scripts if you try to use a custom one.</p>
	      <h2 class="ph3tutorialheader" id="sub4">Part 4: How do I use Custom Replay Save Scripts?</h2>
	      <p>As with other scripts, you can choose to use a custom Replay Save Script. As usual, put them in a directory within your script, and link to it from the System File using a relative path. For example:</p>
	      <pre class="prettyprint"><code>    SetPauseScriptPath(GetCurrentScriptDirectory() ~ "./Pause.dnh");
    SetEndSceneScriptPath(GetCurrentScriptDirectory() ~ "./EndScene.dnh");
    SetReplaySaveSceneScriptPath(GetCurrentScriptDirectory() ~ "./ReplaySaveScene.dnh");</code></pre>
	      <p>Some things you will probably want to do are change the font used, allow for the user to cancel out of <code>TNameEntry</code>, etc.</p>
	      <p>If you decide to handle Replay Comments, however, things get a little hairy. In <code>TNameEntry</code>, you'll have to, before calling <code>SaveReplay()</code>, <code>SetReplayInfo(REPLAY_COMMENT, &lt;your stuff here&gt;)</code>. If you have multiple fields, I suggest delimiting using "/", though this can and will make storing paths difficult. We will likely discuss this in a later tutorial.</p>
	      <h2 class="ph3tutorialheader" id="quiz1">Quiz: Replay Save Scripts</h2>
	        <!--Quiz start.-->
		<p>1) What is the number of replays that can be stored for a given script? </p>
	        <form method="POST" onSubmit="return checkAnswerP(this, 'B', '3');">
	        <input type="RADIO" value="A" name="cc">
	        A. 10<br>
	        <input type="RADIO" value="B" name="cc">
	        B. 99<br>
	        <input type="RADIO" value="C" name="cc">
	        C. 50<br>
	        <input type="SUBMIT" value="Submit">
	        </form>
		<br>
		<p>2) How do you escape the [ character in Danmakufu? </p>
	        <form method="POST" onSubmit="return checkAnswerP(this, 'B', '2');">
	        <input type="RADIO" value="A" name="cc">
	        A. \[<br>
	        <input type="RADIO" value="B" name="cc">
	        B. [osb]<br>
	        <input type="RADIO" value="C" name="cc">
	        C. [csb]<br>
	        <input type="SUBMIT" value="Submit">
	        </form>
		<br>
	      <h2 class="ph3tutorialheader" id="subs">Summary</h2>
	        <ul>
	          <li>Replay Save Scenes run when the option to save a replay is selected from an End Scene</li>
	          <li>Replay Save Scenes have two parts - choosing a replay slot, and name input + saving the replay</li>
	          <li>Replay Save Scenes allow for customizing what information (CommonData, Replay Comments) gets saved to a replay</li>
	        </ul>
	      <h2 class="ph3tutorialheader" id="subf">Sources and External Resources</h2>
	      <p>N/A</p>
	      <br>            </div>          </div>
          <div class="tutnavbar">
	    <ul>
	      <li><a href="./ph3u2l20.html" title="Sparen's Danmakufu ph3 Tutorials - Manipulating Pause and End Scene Files">Unit 2 Lesson 20</a></li>
	      <li><span>Navigation Bar</span></li>
	      <li><a href="./ph3u2l22.html" title="Sparen's Danmakufu ph3 Tutorials - Implementing 2D Backgrounds in Background Files">Unit 2 Lesson 22</a></li>
	    </ul>
	    <br>
          </div>        </div>      </div>      <footer id="footer">      </footer>    </div>
    <script type="text/javascript" src="javascript/ph3tutorialcommon.js"></script>
    <script type="text/javascript" src="javascript/GenericQuiz.js"></script>
    <script type="text/javascript" src="javascript/QReviewP.js"></script>
    <link href="customhighlighter/desert.css" type="text/css" rel="stylesheet" />
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <script type="text/javascript" src="javascript/dnhdocs_standard.js"></script>
    <script type="text/javascript" src="javascript/dnhdocs_object.js"></script>
    <script type="text/javascript" src="javascript/dnhdocs_system.js"></script>
    <script type="text/javascript" src="javascript/dnhdocs.js"></script>  </body></html>